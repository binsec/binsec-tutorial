starting from core

replace <puts> (_) by
  return 0
end

abort at <__stack_chk_fail>

stdin_pos<64> := 0
replace <fgets> (ptr, size, _) by
  for i<64> in 0 to size - 1 do
    @[ptr + i] := stdin[stdin_pos]
    stdin_pos := stdin_pos + 1
  end
  return size
end

reach <puts> such that @[rdi, 8] = "Welcome!" then print c string stdin
cut at <main> return